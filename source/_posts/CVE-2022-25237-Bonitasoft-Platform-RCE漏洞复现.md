---
title: CVE-2022-25237 Bonitasoft Platform RCE漏洞复现
date: 2023-02-13 16:46:37
tags: [CVE漏洞，弱口令]
categories: CVE漏洞复现
---

###  影响范围：

Bonita Platform社区版：2022.1-u0(7.14.0)以下

Bonita Platform订阅版：2022.1-u0(7.14.0)以下						2021.2-u4(7.13.4)以下

​											2021.1-0307(7.12.11)以下				 7.11.7以下

 <!-- more -->

### 一、Bonita介绍

Bonitasoft 是一个业务自动化平台，可以更轻松地在业务流程中构建、部署和管理自动化应用程序。

Bonita 是一个用于业务流程自动化和优化的开源和可扩展平台。

### 二、漏洞介绍

Bonita Web 2021.2版本受到认证绕过影响，因为其API认证过滤器的过滤模式过于宽泛。

通过添加恶意构造的字符串到API URL，普通用户可以访问需特权的API端点。这可能导致特权API操作将恶意代码

添加至服务器，从而造成RCE攻击。

### 三、影响范围

Bonita Platform社区版：2022.1-u0(7.14.0)以下

Bonita Platform订阅版：2022.1-u0(7.14.0)以下						2021.2-u4(7.13.4)以下

​											2021.1-0307(7.12.11)以下				 7.11.7以下

### 四、环境搭建

本地拉取镜像，并在vulfocus靶场导入

```
docker pull bonita:7.13.0
```

![image-20230213165110439](CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213165110439.png)

### 五、漏洞复现

**访问给出的地址**

<img src="CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213165250301.png" alt="image-20230213165250301" style="zoom:80%;" />

可以发现一个登入页面，使用burp工具检测是否存在弱口令

<img src="CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213170056785.png" alt="image-20230213170056785" style="zoom:67%;" />

使用cluster bomb模式，清除所有payload，将用户名和密码的位置改为payload

![image-20230213171309313](CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213171309313.png)

成功发现用户名和密码install / install

**登入界面**

![image-20230213171712469](CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213171712469.png)

<img src="CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213171908500.png" alt="image-20230213171908500" style="zoom:67%;" />

通过浏览可以发现此处的添加用户

![image-20230213204804320](CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213204804320.png)

创建弱口令admin\admin

<img src="CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213204909091.png" alt="image-20230213204909091" style="zoom:67%;" />

如图成功建立admin用户名<img src="CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213205204434.png" alt="image-20230213205204434" style="zoom:67%;" />

**使用脚本**

```
https://github.com/RhinoSecurityLabs/CVEs/tree/master/CVE-2022-25237
```

下载py文件和zip包，放在同一目录下

 https://zhifengmuxue.top/2023/2/13/CVE-2022-25237

在kali中中调用脚本

```
python3 CVE-2022-25237.py admin admin http://ip:port/bonita '指令'
```

![image-20230213212404064](CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213212404064.png)

至此成功寻到flag

![image-20230213212730520](CVE-2022-25237-Bonitasoft-Platform-RCE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/image-20230213212730520.png)

可以执行查看操作系统等操作
